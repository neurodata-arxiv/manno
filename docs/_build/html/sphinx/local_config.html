

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Single Node Configuration &mdash; m2g v1.1.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/ocp_favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="m2g v1.1.0 documentation" href="../index.html"/>
        <link rel="next" title="Cloud Services" href="cloud_computing.html"/>
        <link rel="prev" title="Introduction" href="introduction.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../index.html" class="icon icon-home"> m2g
        

        
          
          <img src="../_static/ocp_main.png" class="logo" />
        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Single Node Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-package-update-and-install">Basic Package Update and Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="#install-and-configure-python-2-7">Install and Configure Python 2.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basics-for-development">Basics for Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="#oracle-java-install">Oracle Java Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="#java-setup">Java Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#camino-and-fsl">Camino and FSL</a></li>
<li class="toctree-l2"><a class="reference internal" href="#igraph">igraph</a></li>
<li class="toctree-l2"><a class="reference internal" href="#m2g-setup">m2g setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#export-paths-and-setup-environment">Export Paths and Setup Environment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cloud_computing.html">Cloud Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="ocp.html">OCP</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ocp.html#contributing">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="ocp.html#style-guides">Style Guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="ocp.html#ocp-support-forums">OCP Support Forums</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions (FAQ)</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/input_data.html">Data Formats</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/input_data.html#input-data">Input Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/input_data.html#output-data">Output Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/available_data.html">Public Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/basic_usage.html">Basic Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/basic_usage.html#m2g-complete-pipeline">m2g Complete Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/basic_usage.html#m2g-registration-pipeline">m2g Registration Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/basic_usage.html#m2g-diffusion-processing-pipeline">m2g Diffusion Processing Pipeline</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/advanced_usage.html">Advanced Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/advanced_usage.html#dti-preprocessing">DTI Preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/advanced_usage.html#registration">Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/advanced_usage.html#diffusion-processing">Diffusion Processing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/validation.html">Validation</a></li>
</ul>
<p class="caption"><span class="caption-text">Further Reading</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/functions.html">Function Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/bet.html">FSL Brain Extraction Tool</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/bet.html#pseudocode">Pseudocode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/bet.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/flirt.html">FSL Linear Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/parse_b.html">Parse B-values/vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/extract_b0.html">Extract B0 Volume</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/eddycorrect.html">FSL Eddy Correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/tensor_gen.html">DTI Tensor Estimation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/tensor_gen.html#pseudocode">Pseudocode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/tensor_gen.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/fiber_gen.html">Fiber Tractography</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/fiber_gen.html#pseudocode">Pseudocode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/fiber_gen.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/fiber_convert.html">Fiber Converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gengraph.html">Graph Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/gengraph.html#intuition-behind-graph-generation">Intuition Behind Graph Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/gengraph.html#pseudocode">Pseudocode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/setup.html">Setup</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://gitter.im/openconnectome/m2g">Gitter chatroom</a></li>
<li class="toctree-l1"><a class="reference external" href="https://groups.google.com/forum/#!forum/ocp-support/">Mailing List</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/openconnectome/m2g">Github repo</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/openconnectome/m2g/releases/">Release Notes</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">m2g</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Single Node Configuration</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/sphinx/local_config.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="single-node-configuration">
<h1>Single Node Configuration<a class="headerlink" href="#single-node-configuration" title="Permalink to this headline">Â¶</a></h1>
<p>m2g requires a number of standard packages, principally python2.7, igraph, numpy, scipy, Oracle Java, R, LONI Pipeline, FSL, and Camino.  Specific installation instructions are provided here for Centos 6.X.</p>
<p>This was tested using a Centos 6 AMI (CentOS 6 x86_64 (2014_09_29) (ami-bc8131d4)).  We recommend attaching external storage using Elastic Block Storage.  The configuration details of an EC2 instance are beyond the scope of this tutorial; more information can be found at aws.amazon.com.  This installation guide should work equally well on a standalone machine.  Many of the dependencies can be satisfied with Anaconda as an alternative.</p>
<p>We recommend Centos6.x for its compatibility with LONI Pipeline.</p>
<div class="section" id="basic-package-update-and-install">
<h2>Basic Package Update and Install<a class="headerlink" href="#basic-package-update-and-install" title="Permalink to this headline">Â¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">export </span><span class="nv">m2g</span><span class="o">=</span>/mrimages <span class="c">#root directory</span>
yum update -y
yum install -y wget gcc elfutils-libelf-devel libstdc++-devel glibc-devel libaio-devel gcc-c++
yum groupinstall -y <span class="s2">&quot;Development tools&quot;</span> <span class="s2">&quot;X Window System&quot;</span> <span class="s2">&quot;Fonts&quot;</span>
yum install -y zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel xz-devel
</pre></div>
</div>
</div>
<div class="section" id="install-and-configure-python-2-7">
<h2>Install and Configure Python 2.7<a class="headerlink" href="#install-and-configure-python-2-7" title="Permalink to this headline">Â¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre>wget http://python.org/ftp/python/2.7.6/Python-2.7.6.tar.xz
tar xf Python-2.7.6.tar.xz
<span class="nb">cd </span>Python-2.7.6
./configure --prefix<span class="o">=</span>/usr/local --enable-unicode<span class="o">=</span>ucs4 --enable-shared <span class="nv">LDFLAGS</span><span class="o">=</span><span class="s2">&quot;-Wl,-rpath /usr/local/lib&quot;</span>
make <span class="o">&amp;&amp;</span> make altinstall

<span class="c"># Make python 2.7 default</span>
<span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="s1">&#39;/usr/local/bin&#39;</span>:<span class="si">${</span><span class="nv">PATH</span><span class="si">}</span>
ln -s /usr/local/bin/python2.7 /usr/local/bin/python
<span class="c"># First get the setup script for Setuptools:</span>
wget https://bitbucket.org/pypa/setuptools/raw/bootstrap/ez_setup.py
<span class="c"># Then install it for Python 2.7:</span>
python2.7 ez_setup.py
easy_install-2.7 pip
</pre></div>
</div>
</div>
<div class="section" id="basics-for-development">
<h2>Basics for Development<a class="headerlink" href="#basics-for-development" title="Permalink to this headline">Â¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#Basics for development</span>
yum install -y java-1.6.0-openjdk-devel cmake vim screen
yum install -y bc
yum install -y epel-release
yum install -y R
pip2.7 install numpy
pip2.7 install ipython
pip2.7 install scipy

easy_install-2.7 argparse
easy_install-2.7 -U distribute
yum -y install libpng-devel
pip2.7 install scikit-image
pip2.7 install nibabel
pip2.7 install Cython <span class="c"># requires &gt;= v0.22</span>
</pre></div>
</div>
</div>
<div class="section" id="oracle-java-install">
<h2>Oracle Java Install<a class="headerlink" href="#oracle-java-install" title="Permalink to this headline">Â¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># Oracle Java Install</span>
mkdir -p <span class="nv">$m2g</span>/src/java
<span class="nb">cd</span> <span class="nv">$m2g</span>/src/java
wget --no-cookies --no-check-certificate --header <span class="s2">&quot;Cookie: gpw_e24=http%3A%2F%2Fwww.oracle.com%2F; oraclelicense=accept-securebackup-cookie&quot;</span> <span class="s2">&quot;http://download.oracle.com/otn-pub/java/jdk/7u71-b14/jdk-7u71-linux-x64.tar.gz&quot;</span>
tar xzf jdk-7u71-linux-x64.tar.gz

<span class="nb">cd</span> <span class="nv">$m2g</span>/src/java/jdk1.7.0_71/
alternatives --install /usr/bin/java java <span class="nv">$m2g</span>/src/java/jdk1.7.0_71/bin/java 2
alternatives --config java <span class="c">#MANUAL STEP:  type 2</span>
</pre></div>
</div>
</div>
<div class="section" id="java-setup">
<h2>Java Setup<a class="headerlink" href="#java-setup" title="Permalink to this headline">Â¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre>alternatives --install /usr/bin/javac javac <span class="nv">$m2g</span>/src/java/jdk1.7.0_71/bin/javac 2
alternatives --set javac <span class="nv">$m2g</span>/src/java/jdk1.7.0_71/bin/javac
alternatives --install /usr/bin/jar jar <span class="nv">$m2g</span>/src/java/jdk1.7.0_71/bin/jar 2
alternatives --set jar <span class="nv">$m2g</span>/src/java/jdk1.7.0_71/bin/jar
</pre></div>
</div>
</div>
<div class="section" id="camino-and-fsl">
<h2>Camino and FSL<a class="headerlink" href="#camino-and-fsl" title="Permalink to this headline">Â¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#Camino</span>
<span class="nb">cd</span> <span class="nv">$m2g</span>/src
git clone git://git.code.sf.net/p/camino/code camino
<span class="nb">cd </span>camino
make
git checkout voxelSpaceStreamlines
make clean
make

<span class="c">#FSL</span>
<span class="c"># Requires completing a form on the FSL website, running</span>
<span class="c"># fslinstaller.py. We&#39;ve stored the obtained binary on</span>
<span class="c"># a server for convenience.</span>
<span class="c"># FSL website: http://fsl.fmrib.ox.ac.uk/fsldownloads/</span>
<span class="nb">cd</span> <span class="nv">$m2g</span>/src/
wget http://openconnecto.me/data/public/MR/m2g_v1_1_0/devs/fsl-5.0.8-centos6_64.tar.gz
tar zxvf fsl-5.0.8-centos6_64.tar.gz
<span class="c">#Delete raw targz if space is tight</span>
</pre></div>
</div>
</div>
<div class="section" id="igraph">
<h2>igraph<a class="headerlink" href="#igraph" title="Permalink to this headline">Â¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># igraph</span>
yum -y install xml2 libxml2-devel
<span class="nb">cd</span> <span class="si">${</span><span class="nv">m2g</span><span class="si">}</span>/src
wget http://igraph.org/nightly/get/c/igraph-0.7.1.tar.gz
tar xvfz igraph-0.7.1.tar.gz
<span class="nb">cd </span>igraph-0.7.1
./configure --prefix<span class="o">=</span><span class="si">${</span><span class="nv">m2g</span><span class="si">}</span>/src/igraph
make
make install

git clone https://gist.github.com/15015a9485d87d8c22e6.git
<span class="nb">cd </span>15015a9485d87d8c22e6
Rscript installRigraph.R <span class="c"># using mirror: &#39;http://ftp.ussg.iu.edu/CRAN/src/contrib/igraph_0.7.1.tar.gz&#39;</span>
<span class="nb">cd</span> ..
rm -rf 15015a9485d87d8c22e6
</pre></div>
</div>
</div>
<div class="section" id="m2g-setup">
<h2>m2g setup<a class="headerlink" href="#m2g-setup" title="Permalink to this headline">Â¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre>easy_install-2.7 python-igraph

<span class="c"># Need to actually clone repo and install LONI</span>
<span class="c"># Also need to SCP data</span>
<span class="nb">cd</span> <span class="si">${</span><span class="nv">m2g</span><span class="si">}</span>/src
git clone https://github.com/openconnectome/m2g.git
<span class="nb">cd </span>m2g
git checkout master <span class="c">#TODO</span>

<span class="nb">export </span><span class="nv">M2G_HOME</span><span class="o">=</span><span class="si">${</span><span class="nv">m2g</span><span class="si">}</span>/src/m2g

<span class="nb">cd</span> <span class="nv">$M2G_HOME</span>/MR-OCP/mrcap
python setup.py install <span class="c">#for z-index</span>

python <span class="nv">$M2G_HOME</span>/packages/utils/setup.py

mkdir <span class="nv">$m2g</span>/data
<span class="nb">cd</span> <span class="nv">$m2g</span>/data
wget http://openconnecto.me/data/public/MR/m2g_v1_1_0/devs/KKI2009-22.tar.gz
tar zxvf KKI2009-22.tar.gz

<span class="nb">cd</span> <span class="nv">$m2g</span>/src
wget http://openconnecto.me/data/public/MR/m2g_v1_1_0/devs/Pipeline-6.0.1-unix.tar.bz2
mkdir loni
tar -xvf Pipeline-6.0.1-unix.tar.bz2 -C loni

<span class="c">#Get demo workflow</span>
<span class="nb">cd</span> <span class="nv">$m2g</span>/src/m2g/library/workflows/
wget http://openconnecto.me/data/public/MR/m2g_v1_1_0/devs/m2g_test.pipe

mkdir <span class="nv">$HOME</span>/.pipeline
<span class="nb">cd</span> <span class="nv">$HOME</span>/.pipeline
wget http://openconnecto.me/data/public/MR/m2g_v1_1_0/devs/preferences.xml
</pre></div>
</div>
</div>
<div class="section" id="export-paths-and-setup-environment">
<h2>Export Paths and Setup Environment<a class="headerlink" href="#export-paths-and-setup-environment" title="Permalink to this headline">Â¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">echo</span> <span class="s2">&quot;export m2g=/mrimages</span>
<span class="s2">export M2G_HOME=</span><span class="si">${</span><span class="nv">m2g</span><span class="si">}</span><span class="s2">/src/m2g</span>
<span class="s2"># Path to FSL</span>
<span class="s2">FSLDIR=</span><span class="si">${</span><span class="nv">m2g</span><span class="si">}</span><span class="s2">/src/fsl</span>
<span class="s2">. </span><span class="si">${</span><span class="nv">FSLDIR</span><span class="si">}</span><span class="s2">/etc/fslconf/fsl.sh</span>
<span class="s2">PATH=</span><span class="si">${</span><span class="nv">FSLDIR</span><span class="si">}</span><span class="s2">/bin:</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="s2"></span>
<span class="s2">export FSLDIR PATH</span>

<span class="s2"># JAVA</span>
<span class="s2">export PATH=</span><span class="si">${</span><span class="nv">m2g</span><span class="si">}</span><span class="s2">/src/java/jdk1.7.0_71/bin:</span><span class="nv">$PATH</span><span class="s2"></span>
<span class="s2">export JAVA_HOME=</span><span class="si">${</span><span class="nv">m2g</span><span class="si">}</span><span class="s2">/src/java/jdk1.7.0_71</span>

<span class="s2">#M2G</span>
<span class="s2">export PATH=&#39;/usr/local/bin&#39;:</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">m2g</span><span class="si">}</span><span class="s2">/src/m2g/MR-OCP/mrcap</span>
<span class="s2">export PATH=</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">m2g</span><span class="si">}</span><span class="s2">/src/m2g/packages/*</span>
<span class="s2">export PYTHONPATH=</span><span class="si">${</span><span class="nv">m2g</span><span class="si">}</span><span class="s2">/src/m2g/MR-OCP</span>
<span class="s2">export PYTHONPATH=</span><span class="si">${</span><span class="nv">PYTHONPATH</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">m2g</span><span class="si">}</span><span class="s2">/src/m2g/MR-OCP/MROCPdjango:</span><span class="si">${</span><span class="nv">M2G_HOME</span><span class="si">}</span><span class="s2">/MR-OCP/mrcap:</span><span class="si">${</span><span class="nv">M2G_HOME</span><span class="si">}</span><span class="s2"></span>

<span class="s2"># Camino</span>
<span class="s2">export PATH=</span><span class="si">${</span><span class="nv">m2g</span><span class="si">}</span><span class="s2">/src/camino/bin:</span><span class="nv">$PATH</span><span class="s2"></span>
<span class="s2">export CAMINO_HEAP_SIZE=4000&quot;</span> &gt; <span class="nv">$m2g</span>/.bashrc
. <span class="nv">$m2g</span>/.bashrc
</pre></div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cloud_computing.html" class="btn btn-neutral float-right" title="Cloud Services" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="introduction.html" class="btn btn-neutral" title="Introduction" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Open Connectome Project.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'v1.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>